Function not returning expected value due to incorrect data type handling.